<!DOCTYPE html>
<html>
<head>
<!--Add chat name-->
</head>
<body>

<h1>Chat log for </h1><input type="text" id="chat_name" name="chat_name" value="">
<div id="chat_log"></div>
<form>
	<input type="text" id="chat_input" name="chat_input" value="Say Hi!">
	<input type="button" value="Send" onclick="send(document.getElementById('chat_input').value)">
</form> 

<script>
	var l = document.getElementById('chat_log');
	var log = function (m) {
		var i = document.createElement('li');
		i.innerText = m;
		l.appendChild(i);
	}
	log('opening websocket connection');
	var s = new WebSocket('ws://raspberrypi');
	s.addEventListener('error', function (m) { log("error"); console.log(m)});
	s.addEventListener('open', function (m) { log("websocket connection open"); });
	s.addEventListener('message', function (m) { log(m.data); });

	
	var send = function (input) {
		let name = document.getElementById("chat_name").value;
		let packet = JSON.stringify({"who": name, "message": input});
		s.send(packet);
		console.log(input);
	}
	</script>
</body>
</html>
